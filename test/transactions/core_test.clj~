(ns transactions.core-test
  (:use clojure.test
        transactions.core
        [clojure.java.io :only [reader]]
        [clojure.string :only [split]]))

(def correct-QIF
  '(
   "!Account",
   "NRäkningar",
   "^",
   "!Type:Bank",
   "D30 /12/11",
   "T-56.50",
   "CR",
   "P",
   "MOne",
   "LAccount:NumberOne",
   "^",
   "D31 /10/11",
   "T49.00",
   "CR",
   "P",
   "MAlpha",
   "LAccount:Alphas",
   "^",
   "D30 /12/11",
   "T-549.00",
   "CR",
   "P",
   "MBeta",
   "LAccount:Alphas",
   "^"
   )
  )

(defn convert-QIF
  [transactions mappings account]
  (+ 1 2))

(defn load-transactions-file
  [file-name]
  (line-seq (reader file-name)))

(def transactions (load-transactions-file "/home/stefan/Documents/Utveckling/clojure/transactions/test/resources/appTestTransactions.txt"))

(defn convert-line
  [line]
  (split line #"\t+"))

(def convert-lines
  (for [line transactions] (convert-line line)))

(defn load-mappings-file
  [filename]
  ())

(deftest correct-QIF-test
  (testing "Correct QIF output given transactions and mappings."
    (is (=
         (convert-QIF
          transactions
          load-mappings-file
          "Räkningar")
         correct-QIF))))
